<html>	
  <head>
    <title>Books API Example</title>
	<!-- <script src="jquery-1.7.1.js" type="text/javascript"></script> -->
  </head>
  <body>
    <div id="content"></div>
	<script type="text/javascript">
	var JSONObject;
	function getCheckedId() {
		for (var i = 0; i < JSONObject.items.length; i++) {
        if (document.getElementById(i).checked == true) return i;
		}
	}
	function GetInfo(input)
	{
		var fileref=document.createElement('script');
		fileref.setAttribute("type","text/javascript");
		fileref.setAttribute("src", "https://www.googleapis.com/books/v1/volumes?q=+"+input+"&callback=handleResponse");
		document.getElementsByTagName("head")[0].appendChild(fileref)
	}
	function parseInfo() {
		var formObject = document.forms["result"];
		var num = getCheckedId();
		var input = JSONObject.items[num];
		var title = input.volumeInfo.title;
		formObject.elements["id_name"].value = title;
		var authors = input.volumeInfo.authors;
		formObject.elements['description'].value=input.volumeInfo.description;
		formObject.elements["id_authors"].value = authors;
		var published_date = input.volumeInfo.publishedDate;
		formObject.elements["id_published_date"].value = authors;
		var description = input.volumeInfo.description;
		formObject.elements["id_description"].value = description;
		var image_link = input.volumeInfo.imageLinks.thumbnail; 
		alert(image_link)
		formObject.elements["id_image_link"].value = image_link;
	}
	function handleResponse(response) {
	JSONObject = response;
	document.getElementById("list").innerHTML="";
	//document.getElementById("Hint").innerHTML= "create new book " + "<a href="/upload/new/">click</a>";
      for (var i = 0; i < response.items.length; i++) {
        var item = response.items[i];
        document.getElementById("list").innerHTML += "<br>" + "<input type=\"radio\" name=\"books\" onclick=\"parseInfo()\" id=\""+i+"\"><img src=\""+item.volumeInfo.imageLinks.smallThumbnail+"\">"+item.volumeInfo.title+"</input>";
      }
	}
	</script>
	<h3>Start typing a name in the input field below:</h3>
	Book name: <input type="text" name="bookName" id="bookName"/>
	<input type="button" value="Search" onclick="GetInfo(document.getElementById('bookName').value)"/>
	<p>Suggestions: <span id="list"></span></p>
	<form id="result" action="/upload" method="post"> 
	<table>
		{{form.as_table}}
	</table>
	<input type="submit" value="Upload" />
	</form>
	<a href="/create">Create Book Information yourself</a>
  </body>
</html>